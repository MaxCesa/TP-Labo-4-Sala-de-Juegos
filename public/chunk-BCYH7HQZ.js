import{Aa as Te,wa as ye,za as we}from"./chunk-RJSEADXU.js";import"./chunk-ZWD5MATX.js";import{Bb as be,Db as _e,Ia as ue,La as V,Ma as de,Sa as me,_a as L,cb as J,da as ce,fb as H,gb as Q,ha as le,hb as X,hc as Me,ib as Y,jb as w,jc as Ce,kb as I,lb as he,lc as xe,mb as U,ob as z,pa as N,pb as T,qa as j,qb as fe,rb as pe,sb as ve,ub as S,vb as ge,wb as G,z as se}from"./chunk-YLSCEX4Z.js";import"./chunk-2F6QYXKT.js";var K={};(function h(n,t,f,d){var C=!!(n.Worker&&n.Blob&&n.Promise&&n.OffscreenCanvas&&n.OffscreenCanvasRenderingContext2D&&n.HTMLCanvasElement&&n.HTMLCanvasElement.prototype.transferControlToOffscreen&&n.URL&&n.URL.createObjectURL),x=typeof Path2D=="function"&&typeof DOMMatrix=="function",P=function(){if(!n.OffscreenCanvas)return!1;var a=new OffscreenCanvas(1,1),e=a.getContext("2d");e.fillRect(0,0,1,1);var r=a.transferToImageBitmap();try{e.createPattern(r,"no-repeat")}catch{return!1}return!0}();function A(){}function k(a){var e=t.exports.Promise,r=e!==void 0?e:n.Promise;return typeof r=="function"?new r(a):(a(A,A),null)}var R=function(a,e){return{transform:function(r){if(a)return r;if(e.has(r))return e.get(r);var o=new OffscreenCanvas(r.width,r.height),s=o.getContext("2d");return s.drawImage(r,0,0),e.set(r,o),o},clear:function(){e.clear()}}}(P,new Map),W=function(){var a=Math.floor(16.666666666666668),e,r,o={},s=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(e=function(c){var l=Math.random();return o[l]=requestAnimationFrame(function i(u){s===u||s+a-1<u?(s=u,delete o[l],c()):o[l]=requestAnimationFrame(i)}),l},r=function(c){o[c]&&cancelAnimationFrame(o[c])}):(e=function(c){return setTimeout(c,a)},r=function(c){return clearTimeout(c)}),{frame:e,cancel:r}}(),Be=function(){var a,e,r={};function o(s){function c(l,i){s.postMessage({options:l||{},callback:i})}s.init=function(i){var u=i.transferControlToOffscreen();s.postMessage({canvas:u},[u])},s.fire=function(i,u,p){if(e)return c(i,null),e;var g=Math.random().toString(36).slice(2);return e=k(function(v){function b(M){M.data.callback===g&&(delete r[g],s.removeEventListener("message",b),e=null,R.clear(),p(),v())}s.addEventListener("message",b),c(i,g),r[g]=b.bind(null,{data:{callback:g}})}),e},s.reset=function(){s.postMessage({reset:!0});for(var i in r)r[i](),delete r[i]}}return function(){if(a)return a;if(!f&&C){var s=["var CONFETTI, SIZE = {}, module = {};","("+h.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{a=new Worker(URL.createObjectURL(new Blob([s])))}catch(c){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("\u{1F38A} Could not load worker",c),null}o(a)}return a}}(),Se={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function Fe(a,e){return e?e(a):a}function Pe(a){return a!=null}function _(a,e,r){return Fe(a&&Pe(a[e])?a[e]:Se[e],r)}function ke(a){return a<0?0:Math.floor(a)}function Re(a,e){return Math.floor(Math.random()*(e-a))+a}function $(a){return parseInt(a,16)}function Oe(a){return a.map(Ve)}function Ve(a){var e=String(a).replace(/[^0-9a-f]/gi,"");return e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),{r:$(e.substring(0,2)),g:$(e.substring(2,4)),b:$(e.substring(4,6))}}function Ae(a){var e=_(a,"origin",Object);return e.x=_(e,"x",Number),e.y=_(e,"y",Number),e}function De(a){a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight}function Ne(a){var e=a.getBoundingClientRect();a.width=e.width,a.height=e.height}function je(a){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.pointerEvents="none",e.style.zIndex=a,e}function ze(a,e,r,o,s,c,l,i,u){a.save(),a.translate(e,r),a.rotate(c),a.scale(o,s),a.arc(0,0,1,l,i,u),a.restore()}function Le(a){var e=a.angle*(Math.PI/180),r=a.spread*(Math.PI/180);return{x:a.x,y:a.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:a.startVelocity*.5+Math.random()*a.startVelocity,angle2D:-e+(.5*r-Math.random()*r),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:a.color,shape:a.shape,tick:0,totalTicks:a.ticks,decay:a.decay,drift:a.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:a.gravity*3,ovalScalar:.6,scalar:a.scalar,flat:a.flat}}function Je(a,e){e.x+=Math.cos(e.angle2D)*e.velocity+e.drift,e.y+=Math.sin(e.angle2D)*e.velocity+e.gravity,e.velocity*=e.decay,e.flat?(e.wobble=0,e.wobbleX=e.x+10*e.scalar,e.wobbleY=e.y+10*e.scalar,e.tiltSin=0,e.tiltCos=0,e.random=1):(e.wobble+=e.wobbleSpeed,e.wobbleX=e.x+10*e.scalar*Math.cos(e.wobble),e.wobbleY=e.y+10*e.scalar*Math.sin(e.wobble),e.tiltAngle+=.1,e.tiltSin=Math.sin(e.tiltAngle),e.tiltCos=Math.cos(e.tiltAngle),e.random=Math.random()+2);var r=e.tick++/e.totalTicks,o=e.x+e.random*e.tiltCos,s=e.y+e.random*e.tiltSin,c=e.wobbleX+e.random*e.tiltCos,l=e.wobbleY+e.random*e.tiltSin;if(a.fillStyle="rgba("+e.color.r+", "+e.color.g+", "+e.color.b+", "+(1-r)+")",a.beginPath(),x&&e.shape.type==="path"&&typeof e.shape.path=="string"&&Array.isArray(e.shape.matrix))a.fill(We(e.shape.path,e.shape.matrix,e.x,e.y,Math.abs(c-o)*.1,Math.abs(l-s)*.1,Math.PI/10*e.wobble));else if(e.shape.type==="bitmap"){var i=Math.PI/10*e.wobble,u=Math.abs(c-o)*.1,p=Math.abs(l-s)*.1,g=e.shape.bitmap.width*e.scalar,v=e.shape.bitmap.height*e.scalar,b=new DOMMatrix([Math.cos(i)*u,Math.sin(i)*u,-Math.sin(i)*p,Math.cos(i)*p,e.x,e.y]);b.multiplySelf(new DOMMatrix(e.shape.matrix));var M=a.createPattern(R.transform(e.shape.bitmap),"no-repeat");M.setTransform(b),a.globalAlpha=1-r,a.fillStyle=M,a.fillRect(e.x-g/2,e.y-v/2,g,v),a.globalAlpha=1}else if(e.shape==="circle")a.ellipse?a.ellipse(e.x,e.y,Math.abs(c-o)*e.ovalScalar,Math.abs(l-s)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):ze(a,e.x,e.y,Math.abs(c-o)*e.ovalScalar,Math.abs(l-s)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI);else if(e.shape==="star")for(var m=Math.PI/2*3,y=4*e.scalar,E=8*e.scalar,B=e.x,O=e.y,D=5,F=Math.PI/D;D--;)B=e.x+Math.cos(m)*E,O=e.y+Math.sin(m)*E,a.lineTo(B,O),m+=F,B=e.x+Math.cos(m)*y,O=e.y+Math.sin(m)*y,a.lineTo(B,O),m+=F;else a.moveTo(Math.floor(e.x),Math.floor(e.y)),a.lineTo(Math.floor(e.wobbleX),Math.floor(s)),a.lineTo(Math.floor(c),Math.floor(l)),a.lineTo(Math.floor(o),Math.floor(e.wobbleY));return a.closePath(),a.fill(),e.tick<e.totalTicks}function Ue(a,e,r,o,s){var c=e.slice(),l=a.getContext("2d"),i,u,p=k(function(g){function v(){i=u=null,l.clearRect(0,0,o.width,o.height),R.clear(),s(),g()}function b(){f&&!(o.width===d.width&&o.height===d.height)&&(o.width=a.width=d.width,o.height=a.height=d.height),!o.width&&!o.height&&(r(a),o.width=a.width,o.height=a.height),l.clearRect(0,0,o.width,o.height),c=c.filter(function(M){return Je(l,M)}),c.length?i=W.frame(b):v()}i=W.frame(b),u=v});return{addFettis:function(g){return c=c.concat(g),p},canvas:a,promise:p,reset:function(){i&&W.cancel(i),u&&u()}}}function ae(a,e){var r=!a,o=!!_(e||{},"resize"),s=!1,c=_(e,"disableForReducedMotion",Boolean),l=C&&!!_(e||{},"useWorker"),i=l?Be():null,u=r?De:Ne,p=a&&i?!!a.__confetti_initialized:!1,g=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,v;function b(m,y,E){for(var B=_(m,"particleCount",ke),O=_(m,"angle",Number),D=_(m,"spread",Number),F=_(m,"startVelocity",Number),Ze=_(m,"decay",Number),He=_(m,"gravity",Number),Qe=_(m,"drift",Number),ne=_(m,"colors",Oe),Xe=_(m,"ticks",Number),re=_(m,"shapes"),Ye=_(m,"scalar"),Ge=!!_(m,"flat"),ie=Ae(m),oe=B,Z=[],Ke=a.width*ie.x,ea=a.height*ie.y;oe--;)Z.push(Le({x:Ke,y:ea,angle:O,spread:D,startVelocity:F,color:ne[oe%ne.length],shape:re[Re(0,re.length)],ticks:Xe,decay:Ze,gravity:He,drift:Qe,scalar:Ye,flat:Ge}));return v?v.addFettis(Z):(v=Ue(a,Z,u,y,E),v.promise)}function M(m){var y=c||_(m,"disableForReducedMotion",Boolean),E=_(m,"zIndex",Number);if(y&&g)return k(function(F){F()});r&&v?a=v.canvas:r&&!a&&(a=je(E),document.body.appendChild(a)),o&&!p&&u(a);var B={width:a.width,height:a.height};i&&!p&&i.init(a),p=!0,i&&(a.__confetti_initialized=!0);function O(){if(i){var F={getBoundingClientRect:function(){if(!r)return a.getBoundingClientRect()}};u(F),i.postMessage({resize:{width:F.width,height:F.height}});return}B.width=B.height=null}function D(){v=null,o&&(s=!1,n.removeEventListener("resize",O)),r&&a&&(document.body.contains(a)&&document.body.removeChild(a),a=null,p=!1)}return o&&!s&&(s=!0,n.addEventListener("resize",O,!1)),i?i.fire(m,B,D):b(m,B,D)}return M.reset=function(){i&&i.reset(),v&&v.reset()},M}var q;function te(){return q||(q=ae(null,{useWorker:!0,resize:!0})),q}function We(a,e,r,o,s,c,l){var i=new Path2D(a),u=new Path2D;u.addPath(i,new DOMMatrix(e));var p=new Path2D;return p.addPath(u,new DOMMatrix([Math.cos(l)*s,Math.sin(l)*s,-Math.sin(l)*c,Math.cos(l)*c,r,o])),p}function $e(a){if(!x)throw new Error("path confetti are not supported in this browser");var e,r;typeof a=="string"?e=a:(e=a.path,r=a.matrix);var o=new Path2D(e),s=document.createElement("canvas"),c=s.getContext("2d");if(!r){for(var l=1e3,i=l,u=l,p=0,g=0,v,b,M=0;M<l;M+=2)for(var m=0;m<l;m+=2)c.isPointInPath(o,M,m,"nonzero")&&(i=Math.min(i,M),u=Math.min(u,m),p=Math.max(p,M),g=Math.max(g,m));v=p-i,b=g-u;var y=10,E=Math.min(y/v,y/b);r=[E,0,0,E,-Math.round(v/2+i)*E,-Math.round(b/2+u)*E]}return{type:"path",path:e,matrix:r}}function qe(a){var e,r=1,o="#000000",s='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof a=="string"?e=a:(e=a.text,r="scalar"in a?a.scalar:r,s="fontFamily"in a?a.fontFamily:s,o="color"in a?a.color:o);var c=10*r,l=""+c+"px "+s,i=new OffscreenCanvas(c,c),u=i.getContext("2d");u.font=l;var p=u.measureText(e),g=Math.ceil(p.actualBoundingBoxRight+p.actualBoundingBoxLeft),v=Math.ceil(p.actualBoundingBoxAscent+p.actualBoundingBoxDescent),b=2,M=p.actualBoundingBoxLeft+b,m=p.actualBoundingBoxAscent+b;g+=b+b,v+=b+b,i=new OffscreenCanvas(g,v),u=i.getContext("2d"),u.font=l,u.fillStyle=o,u.fillText(e,M,m);var y=1/r;return{type:"bitmap",bitmap:i.transferToImageBitmap(),matrix:[y,0,0,y,-g*y/2,-v*y/2]}}t.exports=function(){return te().apply(this,arguments)},t.exports.reset=function(){te().reset()},t.exports.create=ae,t.exports.shapeFromPath=$e,t.exports.shapeFromText=qe})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),K,!1);var Ie=K.exports,ma=K.exports.create;var aa=["campo"],ta=h=>({darken:h});function na(h,n){if(h&1){let t=U();w(0,"div",3)(1,"h1"),S(2,"Buscaminas"),I(),w(3,"button",4),z("click",function(){N(t);let d=T();return j(d.generarCampo(8,8,10))}),S(4,"Principiante"),I(),w(5,"button",4),z("click",function(){N(t);let d=T();return j(d.generarCampo(16,16,40))}),S(6,"Intermedio"),I(),w(7,"button",4),z("click",function(){N(t);let d=T();return j(d.generarCampo(16,30,99))}),S(8,"Dificil"),I()()}}function ra(h,n){if(h&1&&(w(0,"div",9)(1,"p"),S(2),I(),w(3,"p"),S(4),I()()),h&2){let t=T(2);V(2),G("Minas restantes: ",t.cantidadMinas-t.celdasMarcadas,""),V(2),G("Tiempo: ",t.subscribeTimer,"")}}function ia(h,n){h&1&&S(0,"\u{1F6A9}")}function oa(h,n){h&1&&S(0,"\u{1F4A3}")}function sa(h,n){if(h&1&&S(0),h&2){let t=T(2).$implicit;ge(t.minasVecinas>0?t.minasVecinas:"")}}function ca(h,n){if(h&1&&L(0,oa,1,0)(1,sa,1,1),h&2){let t=T().$implicit;H(t.esMina?0:1)}}function la(h,n){if(h&1){let t=U();w(0,"button",11),z("click",function(){let d=N(t).$index,C=T().$index,x=T(2);return j(x.clickIzquierdo(C,d))})("contextmenu",function(d){let C=N(t).$index,x=T().$index,P=T(2);return j(P.clickDerecho(d,x,C))}),L(1,ia,1,0)(2,ca,2,1),I()}if(h&2){let t=n.$implicit;J("ngClass",_e(3,ta,t.estaRevelada))("disabled",t.estaRevelada),V(),H(t.estaMarcada?1:t.estaRevelada?2:-1)}}function ua(h,n){if(h&1&&(w(0,"div",8),X(1,la,3,5,"button",10,Q),I()),h&2){let t=n.$implicit;V(),Y(t)}}function da(h,n){if(h&1){let t=U();w(0,"div",5),L(1,ra,5,2,"div",6),w(2,"div",7),X(3,ua,3,0,"div",8,Q),I(),w(5,"button",4),z("click",function(){N(t);let d=T();return j(d.nuevoJuego())}),S(6,"Nuevo juego"),I()()}if(h&2){let t=T();V(),J("ngIf",!t.terminoElJuego),V(2),Y(t.campo)}}var ee=[[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1],[0,1]],Ee=class h{constructor(n){this.renderer=n}ancho=0;alto=0;cantidadMinas=0;campo=[];coordenadas=[];celdasMarcadas=0;minasBienMarcadas=0;empezoElJuego=!1;subscribeTimer=0;timerSubscription;terminoElJuego=!1;afs=ce(ye);perdiste=!1;container;generarCampo(n,t,f){this.empezoElJuego=!0,this.alto=n,this.ancho=t,this.cantidadMinas=f;for(let d=0;d<this.alto;d++){let C=[];for(let x=0;x<this.ancho;x++)C.push({esMina:!1,estaRevelada:!1,minasVecinas:0,estaMarcada:!1});this.campo.push(C)}this.minarCampo()}minarCampo(){let n=0;for(;n<this.cantidadMinas;){let t=Math.floor(this.alto*Math.random()),f=Math.floor(this.ancho*Math.random());this.campo[t][f].esMina||(this.campo[t][f].esMina=!0,this.coordenadas.push({x:t,y:f}),n++)}for(let{x:t,y:f}of this.coordenadas)for(let d=0;d<ee.length;d++){let[C,x]=ee[d],P=t+C,A=f+x;P>=0&&P<this.alto&&A>=0&&A<this.ancho&&this.campo[P][A].minasVecinas++}this.subscribeTimer=0,this.observableTimer()}observableTimer(){let n=se(0,1e3);this.timerSubscription=n.subscribe(()=>{this.subscribeTimer+=1})}resetTimer(){this.timerSubscription&&this.timerSubscription.unsubscribe(),this.subscribeTimer=0,this.observableTimer()}clickIzquierdo(n,t){if(console.log(this.campo[n][t]),this.campo[n][t].estaRevelada=!0,this.campo[n][t].esMina)return this.perder();if(this.campo[n][t].minasVecinas===0){let f=[[n,t]],d=new Set;for(;f.length>0;){let[C,x]=f.pop();if(this.campo[C][x].estaRevelada=!0,d.add(JSON.stringify([C,x])),!(this.campo[C][x].minasVecinas>0))for(let[P,A]of ee){let k=C+P,R=x+A;k>=0&&k<this.alto&&R>=0&&R<this.ancho&&this.campo[k][R].minasVecinas>=0&&!d.has(JSON.stringify([k,R]))&&f.push([k,R])}}}}clickDerecho(n,t,f){n.preventDefault();let d=this.campo[t][f];this.campo[t][f].estaMarcada?this.celdasMarcadas--:this.celdasMarcadas++,!d.estaMarcada&&d.esMina&&this.minasBienMarcadas++,d.estaMarcada&&d.esMina&&this.minasBienMarcadas--,this.minasBienMarcadas==this.cantidadMinas&&this.celdasMarcadas==this.cantidadMinas?this.ganar():this.campo[t][f].estaMarcada=!this.campo[t][f].estaMarcada}perder(){this.perdiste=!0,this.coordenadas.forEach(n=>{this.campo[n.x][n.y].estaRevelada=!0})}ganar(){if(!this.perdiste){Ie({particleCount:100,spread:70,origin:{y:.6}});var n=Te(this.afs,"puntajesBuscaminas"),t={nombre:localStorage.getItem("user")||"Guest",fecha:new Date,puntaje:this.puntuacion()};we(n,t)}}puntuacion(){let n=200/Math.sqrt(this.subscribeTimer);switch(this.cantidadMinas){case 10:break;case 40:n=2*n;break;case 99:n=3*n;break}return parseInt(n.toFixed(2))}nuevoJuego(){this.empezoElJuego=!1,document.querySelectorAll(".celda").forEach(t=>{this.renderer.removeChild(t.parentNode,t)}),this.cantidadMinas=0,this.campo=[],this.coordenadas=[],this.celdasMarcadas=0,this.minasBienMarcadas=0,this.empezoElJuego=!1,this.timerSubscription.unsubscribe(),this.subscribeTimer=0}static \u0275fac=function(t){return new(t||h)(de(me))};static \u0275cmp=le({type:h,selectors:[["app-buscaminas"]],viewQuery:function(t,f){if(t&1&&fe(aa,5),t&2){let d;pe(d=ve())&&(f.container=d.first)}},standalone:!0,features:[be],decls:4,vars:2,consts:[["href",ue`https://fonts.googleapis.com/css?family=Bungee Hairline`,"rel","stylesheet"],["id","setup",4,"ngIf"],["id","juego",4,"ngIf"],["id","setup"],[3,"click"],["id","juego"],["id","info",4,"ngIf"],["id","campo",1,"campo"],[1,"fila"],["id","info"],[1,"celda",3,"ngClass","disabled"],[1,"celda",3,"click","contextmenu","ngClass","disabled"]],template:function(t,f){t&1&&(w(0,"body"),he(1,"link",0),L(2,na,9,0,"div",1)(3,da,7,1,"div",2),I()),t&2&&(V(2),J("ngIf",!f.empezoElJuego),V(),J("ngIf",f.empezoElJuego))},dependencies:[xe,Me,Ce],styles:['body[_ngcontent-%COMP%]{background-image:url("./media/bombs-publicdomainvectors-GUW575N7.png");background-size:cover}.fila[_ngcontent-%COMP%]{display:flex}.celda[_ngcontent-%COMP%]{width:30px;height:30px}#juego[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:center;top:15%;position:relative;flex-direction:column;z-index:2}#setup[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:center;flex-direction:column;top:20%;position:relative;font-family:Bungee Hairline}#setup[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#fff}#setup[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:20px;height:50px;width:110px;font-family:monospace}#info[_ngcontent-%COMP%]{background-color:#d3d3d3;padding-left:15px;padding-right:15px;z-index:0;border-style:ridge;border-width:2px;border-color:#000}']})};export{Ee as BuscaminasComponent};
