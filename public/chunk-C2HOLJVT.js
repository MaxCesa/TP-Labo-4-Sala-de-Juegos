import{Aa as _e,wa as be,za as Me}from"./chunk-Q7B7XHNI.js";import"./chunk-ZWD5MATX.js";import{Bb as he,Db as fe,Ia as de,La as D,_a as z,cb as L,da as ce,fb as Z,gb as H,gc as pe,ha as le,hb as X,ib as Y,ic as ve,jb as w,kb as F,kc as ge,lb as ue,mb as G,ob as U,pa as N,pb as T,qa as j,ub as k,vb as me,wb as K,z as se}from"./chunk-VEQ6OY37.js";import"./chunk-2F6QYXKT.js";var Q={};(function m(r,n,f,h){var C=!!(r.Worker&&r.Blob&&r.Promise&&r.OffscreenCanvas&&r.OffscreenCanvasRenderingContext2D&&r.HTMLCanvasElement&&r.HTMLCanvasElement.prototype.transferControlToOffscreen&&r.URL&&r.URL.createObjectURL),x=typeof Path2D=="function"&&typeof DOMMatrix=="function",E=function(){if(!r.OffscreenCanvas)return!1;var a=new OffscreenCanvas(1,1),e=a.getContext("2d");e.fillRect(0,0,1,1);var t=a.transferToImageBitmap();try{e.createPattern(t,"no-repeat")}catch{return!1}return!0}();function S(){}function O(a){var e=n.exports.Promise,t=e!==void 0?e:r.Promise;return typeof t=="function"?new t(a):(a(S,S),null)}var R=function(a,e){return{transform:function(t){if(a)return t;if(e.has(t))return e.get(t);var o=new OffscreenCanvas(t.width,t.height),s=o.getContext("2d");return s.drawImage(t,0,0),e.set(t,o),o},clear:function(){e.clear()}}}(E,new Map),W=function(){var a=Math.floor(16.666666666666668),e,t,o={},s=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(e=function(c){var l=Math.random();return o[l]=requestAnimationFrame(function i(d){s===d||s+a-1<d?(s=d,delete o[l],c()):o[l]=requestAnimationFrame(i)}),l},t=function(c){o[c]&&cancelAnimationFrame(o[c])}):(e=function(c){return setTimeout(c,a)},t=function(c){return clearTimeout(c)}),{frame:e,cancel:t}}(),ye=function(){var a,e,t={};function o(s){function c(l,i){s.postMessage({options:l||{},callback:i})}s.init=function(i){var d=i.transferControlToOffscreen();s.postMessage({canvas:d},[d])},s.fire=function(i,d,p){if(e)return c(i,null),e;var g=Math.random().toString(36).slice(2);return e=O(function(v){function b(_){_.data.callback===g&&(delete t[g],s.removeEventListener("message",b),e=null,R.clear(),p(),v())}s.addEventListener("message",b),c(i,g),t[g]=b.bind(null,{data:{callback:g}})}),e},s.reset=function(){s.postMessage({reset:!0});for(var i in t)t[i](),delete t[i]}}return function(){if(a)return a;if(!f&&C){var s=["var CONFETTI, SIZE = {}, module = {};","("+m.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{a=new Worker(URL.createObjectURL(new Blob([s])))}catch(c){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("\u{1F38A} Could not load worker",c),null}o(a)}return a}}(),we={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function Te(a,e){return e?e(a):a}function Ie(a){return a!=null}function M(a,e,t){return Te(a&&Ie(a[e])?a[e]:we[e],t)}function Be(a){return a<0?0:Math.floor(a)}function Fe(a,e){return Math.floor(Math.random()*(e-a))+a}function $(a){return parseInt(a,16)}function Ee(a){return a.map(Pe)}function Pe(a){var e=String(a).replace(/[^0-9a-f]/gi,"");return e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),{r:$(e.substring(0,2)),g:$(e.substring(2,4)),b:$(e.substring(4,6))}}function ke(a){var e=M(a,"origin",Object);return e.x=M(e,"x",Number),e.y=M(e,"y",Number),e}function Se(a){a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight}function Oe(a){var e=a.getBoundingClientRect();a.width=e.width,a.height=e.height}function Re(a){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.pointerEvents="none",e.style.zIndex=a,e}function Ve(a,e,t,o,s,c,l,i,d){a.save(),a.translate(e,t),a.rotate(c),a.scale(o,s),a.arc(0,0,1,l,i,d),a.restore()}function De(a){var e=a.angle*(Math.PI/180),t=a.spread*(Math.PI/180);return{x:a.x,y:a.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:a.startVelocity*.5+Math.random()*a.startVelocity,angle2D:-e+(.5*t-Math.random()*t),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:a.color,shape:a.shape,tick:0,totalTicks:a.ticks,decay:a.decay,drift:a.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:a.gravity*3,ovalScalar:.6,scalar:a.scalar,flat:a.flat}}function Ae(a,e){e.x+=Math.cos(e.angle2D)*e.velocity+e.drift,e.y+=Math.sin(e.angle2D)*e.velocity+e.gravity,e.velocity*=e.decay,e.flat?(e.wobble=0,e.wobbleX=e.x+10*e.scalar,e.wobbleY=e.y+10*e.scalar,e.tiltSin=0,e.tiltCos=0,e.random=1):(e.wobble+=e.wobbleSpeed,e.wobbleX=e.x+10*e.scalar*Math.cos(e.wobble),e.wobbleY=e.y+10*e.scalar*Math.sin(e.wobble),e.tiltAngle+=.1,e.tiltSin=Math.sin(e.tiltAngle),e.tiltCos=Math.cos(e.tiltAngle),e.random=Math.random()+2);var t=e.tick++/e.totalTicks,o=e.x+e.random*e.tiltCos,s=e.y+e.random*e.tiltSin,c=e.wobbleX+e.random*e.tiltCos,l=e.wobbleY+e.random*e.tiltSin;if(a.fillStyle="rgba("+e.color.r+", "+e.color.g+", "+e.color.b+", "+(1-t)+")",a.beginPath(),x&&e.shape.type==="path"&&typeof e.shape.path=="string"&&Array.isArray(e.shape.matrix))a.fill(je(e.shape.path,e.shape.matrix,e.x,e.y,Math.abs(c-o)*.1,Math.abs(l-s)*.1,Math.PI/10*e.wobble));else if(e.shape.type==="bitmap"){var i=Math.PI/10*e.wobble,d=Math.abs(c-o)*.1,p=Math.abs(l-s)*.1,g=e.shape.bitmap.width*e.scalar,v=e.shape.bitmap.height*e.scalar,b=new DOMMatrix([Math.cos(i)*d,Math.sin(i)*d,-Math.sin(i)*p,Math.cos(i)*p,e.x,e.y]);b.multiplySelf(new DOMMatrix(e.shape.matrix));var _=a.createPattern(R.transform(e.shape.bitmap),"no-repeat");_.setTransform(b),a.globalAlpha=1-t,a.fillStyle=_,a.fillRect(e.x-g/2,e.y-v/2,g,v),a.globalAlpha=1}else if(e.shape==="circle")a.ellipse?a.ellipse(e.x,e.y,Math.abs(c-o)*e.ovalScalar,Math.abs(l-s)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):Ve(a,e.x,e.y,Math.abs(c-o)*e.ovalScalar,Math.abs(l-s)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI);else if(e.shape==="star")for(var u=Math.PI/2*3,y=4*e.scalar,I=8*e.scalar,B=e.x,V=e.y,A=5,P=Math.PI/A;A--;)B=e.x+Math.cos(u)*I,V=e.y+Math.sin(u)*I,a.lineTo(B,V),u+=P,B=e.x+Math.cos(u)*y,V=e.y+Math.sin(u)*y,a.lineTo(B,V),u+=P;else a.moveTo(Math.floor(e.x),Math.floor(e.y)),a.lineTo(Math.floor(e.wobbleX),Math.floor(s)),a.lineTo(Math.floor(c),Math.floor(l)),a.lineTo(Math.floor(o),Math.floor(e.wobbleY));return a.closePath(),a.fill(),e.tick<e.totalTicks}function Ne(a,e,t,o,s){var c=e.slice(),l=a.getContext("2d"),i,d,p=O(function(g){function v(){i=d=null,l.clearRect(0,0,o.width,o.height),R.clear(),s(),g()}function b(){f&&!(o.width===h.width&&o.height===h.height)&&(o.width=a.width=h.width,o.height=a.height=h.height),!o.width&&!o.height&&(t(a),o.width=a.width,o.height=a.height),l.clearRect(0,0,o.width,o.height),c=c.filter(function(_){return Ae(l,_)}),c.length?i=W.frame(b):v()}i=W.frame(b),d=v});return{addFettis:function(g){return c=c.concat(g),p},canvas:a,promise:p,reset:function(){i&&W.cancel(i),d&&d()}}}function ae(a,e){var t=!a,o=!!M(e||{},"resize"),s=!1,c=M(e,"disableForReducedMotion",Boolean),l=C&&!!M(e||{},"useWorker"),i=l?ye():null,d=t?Se:Oe,p=a&&i?!!a.__confetti_initialized:!1,g=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,v;function b(u,y,I){for(var B=M(u,"particleCount",Be),V=M(u,"angle",Number),A=M(u,"spread",Number),P=M(u,"startVelocity",Number),Ue=M(u,"decay",Number),We=M(u,"gravity",Number),$e=M(u,"drift",Number),te=M(u,"colors",Ee),Je=M(u,"ticks",Number),re=M(u,"shapes"),qe=M(u,"scalar"),Ze=!!M(u,"flat"),ie=ke(u),oe=B,q=[],He=a.width*ie.x,Xe=a.height*ie.y;oe--;)q.push(De({x:He,y:Xe,angle:V,spread:A,startVelocity:P,color:te[oe%te.length],shape:re[Fe(0,re.length)],ticks:Je,decay:Ue,gravity:We,drift:$e,scalar:qe,flat:Ze}));return v?v.addFettis(q):(v=Ne(a,q,d,y,I),v.promise)}function _(u){var y=c||M(u,"disableForReducedMotion",Boolean),I=M(u,"zIndex",Number);if(y&&g)return O(function(P){P()});t&&v?a=v.canvas:t&&!a&&(a=Re(I),document.body.appendChild(a)),o&&!p&&d(a);var B={width:a.width,height:a.height};i&&!p&&i.init(a),p=!0,i&&(a.__confetti_initialized=!0);function V(){if(i){var P={getBoundingClientRect:function(){if(!t)return a.getBoundingClientRect()}};d(P),i.postMessage({resize:{width:P.width,height:P.height}});return}B.width=B.height=null}function A(){v=null,o&&(s=!1,r.removeEventListener("resize",V)),t&&a&&(document.body.contains(a)&&document.body.removeChild(a),a=null,p=!1)}return o&&!s&&(s=!0,r.addEventListener("resize",V,!1)),i?i.fire(u,B,A):b(u,B,A)}return _.reset=function(){i&&i.reset(),v&&v.reset()},_}var J;function ne(){return J||(J=ae(null,{useWorker:!0,resize:!0})),J}function je(a,e,t,o,s,c,l){var i=new Path2D(a),d=new Path2D;d.addPath(i,new DOMMatrix(e));var p=new Path2D;return p.addPath(d,new DOMMatrix([Math.cos(l)*s,Math.sin(l)*s,-Math.sin(l)*c,Math.cos(l)*c,t,o])),p}function ze(a){if(!x)throw new Error("path confetti are not supported in this browser");var e,t;typeof a=="string"?e=a:(e=a.path,t=a.matrix);var o=new Path2D(e),s=document.createElement("canvas"),c=s.getContext("2d");if(!t){for(var l=1e3,i=l,d=l,p=0,g=0,v,b,_=0;_<l;_+=2)for(var u=0;u<l;u+=2)c.isPointInPath(o,_,u,"nonzero")&&(i=Math.min(i,_),d=Math.min(d,u),p=Math.max(p,_),g=Math.max(g,u));v=p-i,b=g-d;var y=10,I=Math.min(y/v,y/b);t=[I,0,0,I,-Math.round(v/2+i)*I,-Math.round(b/2+d)*I]}return{type:"path",path:e,matrix:t}}function Le(a){var e,t=1,o="#000000",s='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof a=="string"?e=a:(e=a.text,t="scalar"in a?a.scalar:t,s="fontFamily"in a?a.fontFamily:s,o="color"in a?a.color:o);var c=10*t,l=""+c+"px "+s,i=new OffscreenCanvas(c,c),d=i.getContext("2d");d.font=l;var p=d.measureText(e),g=Math.ceil(p.actualBoundingBoxRight+p.actualBoundingBoxLeft),v=Math.ceil(p.actualBoundingBoxAscent+p.actualBoundingBoxDescent),b=2,_=p.actualBoundingBoxLeft+b,u=p.actualBoundingBoxAscent+b;g+=b+b,v+=b+b,i=new OffscreenCanvas(g,v),d=i.getContext("2d"),d.font=l,d.fillStyle=o,d.fillText(e,_,u);var y=1/t;return{type:"bitmap",bitmap:i.transferToImageBitmap(),matrix:[y,0,0,y,-g*y/2,-v*y/2]}}n.exports=function(){return ne().apply(this,arguments)},n.exports.reset=function(){ne().reset()},n.exports.create=ae,n.exports.shapeFromPath=ze,n.exports.shapeFromText=Le})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),Q,!1);var Ce=Q.exports,oa=Q.exports.create;var Ye=m=>({darken:m});function Ge(m,r){if(m&1){let n=G();w(0,"div",3)(1,"h1"),k(2,"Buscaminas"),F(),w(3,"button",4),U("click",function(){N(n);let h=T();return j(h.generarCampo(8,8,10))}),k(4,"Principiante"),F(),w(5,"button",4),U("click",function(){N(n);let h=T();return j(h.generarCampo(16,16,40))}),k(6,"Intermedio"),F(),w(7,"button",4),U("click",function(){N(n);let h=T();return j(h.generarCampo(16,30,99))}),k(8,"Dificil"),F()()}}function Ke(m,r){if(m&1&&(w(0,"div",9)(1,"p"),k(2),F(),w(3,"p"),k(4),F()()),m&2){let n=T(2);D(2),K("Minas restantes: ",n.cantidadMinas-n.celdasMarcadas,""),D(2),K("Tiempo: ",n.subscribeTimer,"")}}function Qe(m,r){m&1&&k(0,"\u{1F6A9}")}function ea(m,r){m&1&&k(0,"\u{1F4A3}")}function aa(m,r){if(m&1&&k(0),m&2){let n=T(2).$implicit;me(n.minasVecinas>0?n.minasVecinas:"")}}function na(m,r){if(m&1&&z(0,ea,1,0)(1,aa,1,1),m&2){let n=T().$implicit;Z(n.esMina?0:1)}}function ta(m,r){if(m&1){let n=G();w(0,"button",11),U("click",function(){let h=N(n).$index,C=T().$index,x=T(2);return j(x.clickIzquierdo(C,h))})("contextmenu",function(h){let C=N(n).$index,x=T().$index,E=T(2);return j(E.clickDerecho(h,x,C))}),z(1,Qe,1,0)(2,na,2,1),F()}if(m&2){let n=r.$implicit;L("ngClass",fe(3,Ye,n.estaRevelada))("disabled",n.estaRevelada),D(),Z(n.estaMarcada?1:n.estaRevelada?2:-1)}}function ra(m,r){if(m&1&&(w(0,"div",8),X(1,ta,3,5,"button",10,H),F()),m&2){let n=r.$implicit;D(),Y(n)}}function ia(m,r){if(m&1&&(w(0,"div",5),z(1,Ke,5,2,"div",6),w(2,"div",7),X(3,ra,3,0,"div",8,H),F()()),m&2){let n=T();D(),L("ngIf",!n.terminoElJuego),D(2),Y(n.campo)}}var ee=[[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1],[0,1]],xe=class m{ancho=0;alto=0;cantidadMinas=0;campo=[];coordenadas=[];celdasMarcadas=0;minasBienMarcadas=0;empezoElJuego=!1;subscribeTimer=0;terminoElJuego=!1;afs=ce(be);constructor(){}generarCampo(r,n,f){this.empezoElJuego=!0,this.alto=r,this.ancho=n,this.cantidadMinas=f;for(let h=0;h<this.alto;h++){let C=[];for(let x=0;x<this.ancho;x++)C.push({esMina:!1,estaRevelada:!1,minasVecinas:0,estaMarcada:!1});this.campo.push(C)}this.minarCampo()}minarCampo(){let r=0;for(;r<this.cantidadMinas;){let n=Math.floor(this.alto*Math.random()),f=Math.floor(this.ancho*Math.random());this.campo[n][f].esMina||(this.campo[n][f].esMina=!0,this.coordenadas.push({x:n,y:f}),r++)}for(let{x:n,y:f}of this.coordenadas)for(let h=0;h<ee.length;h++){let[C,x]=ee[h],E=n+C,S=f+x;E>=0&&E<this.alto&&S>=0&&S<this.ancho&&(console.log("Celda: %d %d. Celda vecina: ",n,f,E,S),this.campo[E][S].minasVecinas++)}this.subscribeTimer=0,this.observableTimer()}observableTimer(){let n=se(0,1e3).subscribe(()=>{this.subscribeTimer+=1})}clickIzquierdo(r,n){if(console.log(this.campo[r][n]),this.campo[r][n].estaRevelada=!0,this.campo[r][n].esMina)return this.perder();if(this.campo[r][n].minasVecinas===0){let f=[[r,n]],h=new Set;for(;f.length>0;){let[C,x]=f.pop();if(this.campo[C][x].estaRevelada=!0,h.add(JSON.stringify([C,x])),!(this.campo[C][x].minasVecinas>0))for(let[E,S]of ee){let O=C+E,R=x+S;O>=0&&O<this.alto&&R>=0&&R<this.ancho&&this.campo[O][R].minasVecinas>=0&&!h.has(JSON.stringify([O,R]))&&f.push([O,R])}}}}clickDerecho(r,n,f){r.preventDefault();let h=this.campo[n][f];console.log("Minas bien marcadas: %d - Celdas marcadas: %d",this.minasBienMarcadas,this.celdasMarcadas),this.campo[n][f].estaMarcada?this.celdasMarcadas--:this.celdasMarcadas++,!h.estaMarcada&&h.esMina&&this.minasBienMarcadas++,h.estaMarcada&&h.esMina&&this.minasBienMarcadas--,this.minasBienMarcadas==this.cantidadMinas&&this.celdasMarcadas==this.cantidadMinas?this.ganar():this.campo[n][f].estaMarcada=!this.campo[n][f].estaMarcada}perder(){this.coordenadas.forEach(r=>{this.campo[r.x][r.y].estaRevelada=!0})}ganar(){Ce({particleCount:100,spread:70,origin:{y:.6}});var r=_e(this.afs,"puntajesBuscaminas"),n={nombre:localStorage.getItem("user"),fecha:Date.now(),puntaje:this.puntuacion()};Me(r,n)}puntuacion(){let r=200/Math.sqrt(this.subscribeTimer);switch(this.cantidadMinas){case 10:break;case 40:r=2*r;break;case 99:r=3*r;break}return r}static \u0275fac=function(n){return new(n||m)};static \u0275cmp=le({type:m,selectors:[["app-buscaminas"]],standalone:!0,features:[he],decls:4,vars:2,consts:[["href",de`https://fonts.googleapis.com/css?family=Bungee Hairline`,"rel","stylesheet"],["id","setup",4,"ngIf"],["id","juego",4,"ngIf"],["id","setup"],[3,"click"],["id","juego"],["id","info",4,"ngIf"],["id","campo",1,"campo"],[1,"fila"],["id","info"],[1,"celda",3,"ngClass","disabled"],[1,"celda",3,"click","contextmenu","ngClass","disabled"]],template:function(n,f){n&1&&(w(0,"body"),ue(1,"link",0),z(2,Ge,9,0,"div",1)(3,ia,5,1,"div",2),F()),n&2&&(D(2),L("ngIf",!f.empezoElJuego),D(),L("ngIf",f.empezoElJuego))},dependencies:[ge,pe,ve],styles:['body[_ngcontent-%COMP%]{background-image:url("./media/bombs-publicdomainvectors-GUW575N7.png");background-size:cover}.fila[_ngcontent-%COMP%]{display:flex}.celda[_ngcontent-%COMP%]{width:30px;height:30px}#juego[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:center;top:15%;position:relative;flex-direction:column;z-index:2}#setup[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:center;flex-direction:column;top:20%;position:relative;font-family:Bungee Hairline}#setup[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#fff}#setup[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:20px;height:50px;width:110px;font-family:monospace}#info[_ngcontent-%COMP%]{background-color:#d3d3d3;padding-left:15px;padding-right:15px;z-index:0;border-style:ridge;border-width:2px;border-color:#000}']})};export{xe as BuscaminasComponent};
