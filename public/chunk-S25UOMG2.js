import{Aa as Te,wa as ye,za as we}from"./chunk-Q7B7XHNI.js";import"./chunk-ZWD5MATX.js";import{Bb as be,Db as _e,Ia as de,La as V,Ma as ue,Sa as me,_a as L,cb as U,da as ce,fb as H,gb as Q,gc as Me,ha as le,hb as X,ib as Y,ic as Ce,jb as w,kb as I,kc as xe,lb as he,mb as W,ob as z,pa as N,pb as T,qa as j,qb as fe,rb as pe,sb as ve,ub as F,vb as ge,wb as G,z as se}from"./chunk-VEQ6OY37.js";import"./chunk-2F6QYXKT.js";var K={};(function h(t,n,f,u){var C=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),x=typeof Path2D=="function"&&typeof DOMMatrix=="function",k=function(){if(!t.OffscreenCanvas)return!1;var a=new OffscreenCanvas(1,1),e=a.getContext("2d");e.fillRect(0,0,1,1);var r=a.transferToImageBitmap();try{e.createPattern(r,"no-repeat")}catch{return!1}return!0}();function A(){}function S(a){var e=n.exports.Promise,r=e!==void 0?e:t.Promise;return typeof r=="function"?new r(a):(a(A,A),null)}var R=function(a,e){return{transform:function(r){if(a)return r;if(e.has(r))return e.get(r);var o=new OffscreenCanvas(r.width,r.height),s=o.getContext("2d");return s.drawImage(r,0,0),e.set(r,o),o},clear:function(){e.clear()}}}(k,new Map),$=function(){var a=Math.floor(16.666666666666668),e,r,o={},s=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(e=function(c){var l=Math.random();return o[l]=requestAnimationFrame(function i(d){s===d||s+a-1<d?(s=d,delete o[l],c()):o[l]=requestAnimationFrame(i)}),l},r=function(c){o[c]&&cancelAnimationFrame(o[c])}):(e=function(c){return setTimeout(c,a)},r=function(c){return clearTimeout(c)}),{frame:e,cancel:r}}(),Be=function(){var a,e,r={};function o(s){function c(l,i){s.postMessage({options:l||{},callback:i})}s.init=function(i){var d=i.transferControlToOffscreen();s.postMessage({canvas:d},[d])},s.fire=function(i,d,p){if(e)return c(i,null),e;var g=Math.random().toString(36).slice(2);return e=S(function(v){function b(M){M.data.callback===g&&(delete r[g],s.removeEventListener("message",b),e=null,R.clear(),p(),v())}s.addEventListener("message",b),c(i,g),r[g]=b.bind(null,{data:{callback:g}})}),e},s.reset=function(){s.postMessage({reset:!0});for(var i in r)r[i](),delete r[i]}}return function(){if(a)return a;if(!f&&C){var s=["var CONFETTI, SIZE = {}, module = {};","("+h.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{a=new Worker(URL.createObjectURL(new Blob([s])))}catch(c){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("\u{1F38A} Could not load worker",c),null}o(a)}return a}}(),Fe={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function Pe(a,e){return e?e(a):a}function ke(a){return a!=null}function _(a,e,r){return Pe(a&&ke(a[e])?a[e]:Fe[e],r)}function Se(a){return a<0?0:Math.floor(a)}function Re(a,e){return Math.floor(Math.random()*(e-a))+a}function J(a){return parseInt(a,16)}function Oe(a){return a.map(Ve)}function Ve(a){var e=String(a).replace(/[^0-9a-f]/gi,"");return e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),{r:J(e.substring(0,2)),g:J(e.substring(2,4)),b:J(e.substring(4,6))}}function Ae(a){var e=_(a,"origin",Object);return e.x=_(e,"x",Number),e.y=_(e,"y",Number),e}function De(a){a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight}function Ne(a){var e=a.getBoundingClientRect();a.width=e.width,a.height=e.height}function je(a){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.pointerEvents="none",e.style.zIndex=a,e}function ze(a,e,r,o,s,c,l,i,d){a.save(),a.translate(e,r),a.rotate(c),a.scale(o,s),a.arc(0,0,1,l,i,d),a.restore()}function Le(a){var e=a.angle*(Math.PI/180),r=a.spread*(Math.PI/180);return{x:a.x,y:a.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:a.startVelocity*.5+Math.random()*a.startVelocity,angle2D:-e+(.5*r-Math.random()*r),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:a.color,shape:a.shape,tick:0,totalTicks:a.ticks,decay:a.decay,drift:a.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:a.gravity*3,ovalScalar:.6,scalar:a.scalar,flat:a.flat}}function Ue(a,e){e.x+=Math.cos(e.angle2D)*e.velocity+e.drift,e.y+=Math.sin(e.angle2D)*e.velocity+e.gravity,e.velocity*=e.decay,e.flat?(e.wobble=0,e.wobbleX=e.x+10*e.scalar,e.wobbleY=e.y+10*e.scalar,e.tiltSin=0,e.tiltCos=0,e.random=1):(e.wobble+=e.wobbleSpeed,e.wobbleX=e.x+10*e.scalar*Math.cos(e.wobble),e.wobbleY=e.y+10*e.scalar*Math.sin(e.wobble),e.tiltAngle+=.1,e.tiltSin=Math.sin(e.tiltAngle),e.tiltCos=Math.cos(e.tiltAngle),e.random=Math.random()+2);var r=e.tick++/e.totalTicks,o=e.x+e.random*e.tiltCos,s=e.y+e.random*e.tiltSin,c=e.wobbleX+e.random*e.tiltCos,l=e.wobbleY+e.random*e.tiltSin;if(a.fillStyle="rgba("+e.color.r+", "+e.color.g+", "+e.color.b+", "+(1-r)+")",a.beginPath(),x&&e.shape.type==="path"&&typeof e.shape.path=="string"&&Array.isArray(e.shape.matrix))a.fill($e(e.shape.path,e.shape.matrix,e.x,e.y,Math.abs(c-o)*.1,Math.abs(l-s)*.1,Math.PI/10*e.wobble));else if(e.shape.type==="bitmap"){var i=Math.PI/10*e.wobble,d=Math.abs(c-o)*.1,p=Math.abs(l-s)*.1,g=e.shape.bitmap.width*e.scalar,v=e.shape.bitmap.height*e.scalar,b=new DOMMatrix([Math.cos(i)*d,Math.sin(i)*d,-Math.sin(i)*p,Math.cos(i)*p,e.x,e.y]);b.multiplySelf(new DOMMatrix(e.shape.matrix));var M=a.createPattern(R.transform(e.shape.bitmap),"no-repeat");M.setTransform(b),a.globalAlpha=1-r,a.fillStyle=M,a.fillRect(e.x-g/2,e.y-v/2,g,v),a.globalAlpha=1}else if(e.shape==="circle")a.ellipse?a.ellipse(e.x,e.y,Math.abs(c-o)*e.ovalScalar,Math.abs(l-s)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):ze(a,e.x,e.y,Math.abs(c-o)*e.ovalScalar,Math.abs(l-s)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI);else if(e.shape==="star")for(var m=Math.PI/2*3,y=4*e.scalar,E=8*e.scalar,B=e.x,O=e.y,D=5,P=Math.PI/D;D--;)B=e.x+Math.cos(m)*E,O=e.y+Math.sin(m)*E,a.lineTo(B,O),m+=P,B=e.x+Math.cos(m)*y,O=e.y+Math.sin(m)*y,a.lineTo(B,O),m+=P;else a.moveTo(Math.floor(e.x),Math.floor(e.y)),a.lineTo(Math.floor(e.wobbleX),Math.floor(s)),a.lineTo(Math.floor(c),Math.floor(l)),a.lineTo(Math.floor(o),Math.floor(e.wobbleY));return a.closePath(),a.fill(),e.tick<e.totalTicks}function We(a,e,r,o,s){var c=e.slice(),l=a.getContext("2d"),i,d,p=S(function(g){function v(){i=d=null,l.clearRect(0,0,o.width,o.height),R.clear(),s(),g()}function b(){f&&!(o.width===u.width&&o.height===u.height)&&(o.width=a.width=u.width,o.height=a.height=u.height),!o.width&&!o.height&&(r(a),o.width=a.width,o.height=a.height),l.clearRect(0,0,o.width,o.height),c=c.filter(function(M){return Ue(l,M)}),c.length?i=$.frame(b):v()}i=$.frame(b),d=v});return{addFettis:function(g){return c=c.concat(g),p},canvas:a,promise:p,reset:function(){i&&$.cancel(i),d&&d()}}}function ae(a,e){var r=!a,o=!!_(e||{},"resize"),s=!1,c=_(e,"disableForReducedMotion",Boolean),l=C&&!!_(e||{},"useWorker"),i=l?Be():null,d=r?De:Ne,p=a&&i?!!a.__confetti_initialized:!1,g=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,v;function b(m,y,E){for(var B=_(m,"particleCount",Se),O=_(m,"angle",Number),D=_(m,"spread",Number),P=_(m,"startVelocity",Number),Ze=_(m,"decay",Number),He=_(m,"gravity",Number),Qe=_(m,"drift",Number),te=_(m,"colors",Oe),Xe=_(m,"ticks",Number),re=_(m,"shapes"),Ye=_(m,"scalar"),Ge=!!_(m,"flat"),ie=Ae(m),oe=B,Z=[],Ke=a.width*ie.x,ea=a.height*ie.y;oe--;)Z.push(Le({x:Ke,y:ea,angle:O,spread:D,startVelocity:P,color:te[oe%te.length],shape:re[Re(0,re.length)],ticks:Xe,decay:Ze,gravity:He,drift:Qe,scalar:Ye,flat:Ge}));return v?v.addFettis(Z):(v=We(a,Z,d,y,E),v.promise)}function M(m){var y=c||_(m,"disableForReducedMotion",Boolean),E=_(m,"zIndex",Number);if(y&&g)return S(function(P){P()});r&&v?a=v.canvas:r&&!a&&(a=je(E),document.body.appendChild(a)),o&&!p&&d(a);var B={width:a.width,height:a.height};i&&!p&&i.init(a),p=!0,i&&(a.__confetti_initialized=!0);function O(){if(i){var P={getBoundingClientRect:function(){if(!r)return a.getBoundingClientRect()}};d(P),i.postMessage({resize:{width:P.width,height:P.height}});return}B.width=B.height=null}function D(){v=null,o&&(s=!1,t.removeEventListener("resize",O)),r&&a&&(document.body.contains(a)&&document.body.removeChild(a),a=null,p=!1)}return o&&!s&&(s=!0,t.addEventListener("resize",O,!1)),i?i.fire(m,B,D):b(m,B,D)}return M.reset=function(){i&&i.reset(),v&&v.reset()},M}var q;function ne(){return q||(q=ae(null,{useWorker:!0,resize:!0})),q}function $e(a,e,r,o,s,c,l){var i=new Path2D(a),d=new Path2D;d.addPath(i,new DOMMatrix(e));var p=new Path2D;return p.addPath(d,new DOMMatrix([Math.cos(l)*s,Math.sin(l)*s,-Math.sin(l)*c,Math.cos(l)*c,r,o])),p}function Je(a){if(!x)throw new Error("path confetti are not supported in this browser");var e,r;typeof a=="string"?e=a:(e=a.path,r=a.matrix);var o=new Path2D(e),s=document.createElement("canvas"),c=s.getContext("2d");if(!r){for(var l=1e3,i=l,d=l,p=0,g=0,v,b,M=0;M<l;M+=2)for(var m=0;m<l;m+=2)c.isPointInPath(o,M,m,"nonzero")&&(i=Math.min(i,M),d=Math.min(d,m),p=Math.max(p,M),g=Math.max(g,m));v=p-i,b=g-d;var y=10,E=Math.min(y/v,y/b);r=[E,0,0,E,-Math.round(v/2+i)*E,-Math.round(b/2+d)*E]}return{type:"path",path:e,matrix:r}}function qe(a){var e,r=1,o="#000000",s='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof a=="string"?e=a:(e=a.text,r="scalar"in a?a.scalar:r,s="fontFamily"in a?a.fontFamily:s,o="color"in a?a.color:o);var c=10*r,l=""+c+"px "+s,i=new OffscreenCanvas(c,c),d=i.getContext("2d");d.font=l;var p=d.measureText(e),g=Math.ceil(p.actualBoundingBoxRight+p.actualBoundingBoxLeft),v=Math.ceil(p.actualBoundingBoxAscent+p.actualBoundingBoxDescent),b=2,M=p.actualBoundingBoxLeft+b,m=p.actualBoundingBoxAscent+b;g+=b+b,v+=b+b,i=new OffscreenCanvas(g,v),d=i.getContext("2d"),d.font=l,d.fillStyle=o,d.fillText(e,M,m);var y=1/r;return{type:"bitmap",bitmap:i.transferToImageBitmap(),matrix:[y,0,0,y,-g*y/2,-v*y/2]}}n.exports=function(){return ne().apply(this,arguments)},n.exports.reset=function(){ne().reset()},n.exports.create=ae,n.exports.shapeFromPath=Je,n.exports.shapeFromText=qe})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),K,!1);var Ie=K.exports,ma=K.exports.create;var aa=["campo"],na=h=>({darken:h});function ta(h,t){if(h&1){let n=W();w(0,"div",3)(1,"h1"),F(2,"Buscaminas"),I(),w(3,"button",4),z("click",function(){N(n);let u=T();return j(u.generarCampo(8,8,10))}),F(4,"Principiante"),I(),w(5,"button",4),z("click",function(){N(n);let u=T();return j(u.generarCampo(16,16,40))}),F(6,"Intermedio"),I(),w(7,"button",4),z("click",function(){N(n);let u=T();return j(u.generarCampo(16,30,99))}),F(8,"Dificil"),I()()}}function ra(h,t){if(h&1&&(w(0,"div",9)(1,"p"),F(2),I(),w(3,"p"),F(4),I()()),h&2){let n=T(2);V(2),G("Minas restantes: ",n.cantidadMinas-n.celdasMarcadas,""),V(2),G("Tiempo: ",n.subscribeTimer,"")}}function ia(h,t){h&1&&F(0,"\u{1F6A9}")}function oa(h,t){h&1&&F(0,"\u{1F4A3}")}function sa(h,t){if(h&1&&F(0),h&2){let n=T(2).$implicit;ge(n.minasVecinas>0?n.minasVecinas:"")}}function ca(h,t){if(h&1&&L(0,oa,1,0)(1,sa,1,1),h&2){let n=T().$implicit;H(n.esMina?0:1)}}function la(h,t){if(h&1){let n=W();w(0,"button",11),z("click",function(){let u=N(n).$index,C=T().$index,x=T(2);return j(x.clickIzquierdo(C,u))})("contextmenu",function(u){let C=N(n).$index,x=T().$index,k=T(2);return j(k.clickDerecho(u,x,C))}),L(1,ia,1,0)(2,ca,2,1),I()}if(h&2){let n=t.$implicit;U("ngClass",_e(3,na,n.estaRevelada))("disabled",n.estaRevelada),V(),H(n.estaMarcada?1:n.estaRevelada?2:-1)}}function da(h,t){if(h&1&&(w(0,"div",8),X(1,la,3,5,"button",10,Q),I()),h&2){let n=t.$implicit;V(),Y(n)}}function ua(h,t){if(h&1){let n=W();w(0,"div",5),L(1,ra,5,2,"div",6),w(2,"div",7),X(3,da,3,0,"div",8,Q),I(),w(5,"button",4),z("click",function(){N(n);let u=T();return j(u.nuevoJuego())}),F(6,"Nuevo juego"),I()()}if(h&2){let n=T();V(),U("ngIf",!n.terminoElJuego),V(2),Y(n.campo)}}var ee=[[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1],[0,1]],Ee=class h{constructor(t){this.renderer=t}ancho=0;alto=0;cantidadMinas=0;campo=[];coordenadas=[];celdasMarcadas=0;minasBienMarcadas=0;empezoElJuego=!1;subscribeTimer=0;terminoElJuego=!1;afs=ce(ye);perdiste=!1;container;generarCampo(t,n,f){this.empezoElJuego=!0,this.alto=t,this.ancho=n,this.cantidadMinas=f;for(let u=0;u<this.alto;u++){let C=[];for(let x=0;x<this.ancho;x++)C.push({esMina:!1,estaRevelada:!1,minasVecinas:0,estaMarcada:!1});this.campo.push(C)}this.minarCampo()}minarCampo(){let t=0;for(;t<this.cantidadMinas;){let n=Math.floor(this.alto*Math.random()),f=Math.floor(this.ancho*Math.random());this.campo[n][f].esMina||(this.campo[n][f].esMina=!0,this.coordenadas.push({x:n,y:f}),t++)}for(let{x:n,y:f}of this.coordenadas)for(let u=0;u<ee.length;u++){let[C,x]=ee[u],k=n+C,A=f+x;k>=0&&k<this.alto&&A>=0&&A<this.ancho&&this.campo[k][A].minasVecinas++}this.subscribeTimer=0,this.observableTimer()}observableTimer(){let n=se(0,1e3).subscribe(()=>{this.subscribeTimer+=1})}clickIzquierdo(t,n){if(console.log(this.campo[t][n]),this.campo[t][n].estaRevelada=!0,this.campo[t][n].esMina)return this.perder();if(this.campo[t][n].minasVecinas===0){let f=[[t,n]],u=new Set;for(;f.length>0;){let[C,x]=f.pop();if(this.campo[C][x].estaRevelada=!0,u.add(JSON.stringify([C,x])),!(this.campo[C][x].minasVecinas>0))for(let[k,A]of ee){let S=C+k,R=x+A;S>=0&&S<this.alto&&R>=0&&R<this.ancho&&this.campo[S][R].minasVecinas>=0&&!u.has(JSON.stringify([S,R]))&&f.push([S,R])}}}}clickDerecho(t,n,f){t.preventDefault();let u=this.campo[n][f];this.campo[n][f].estaMarcada?this.celdasMarcadas--:this.celdasMarcadas++,!u.estaMarcada&&u.esMina&&this.minasBienMarcadas++,u.estaMarcada&&u.esMina&&this.minasBienMarcadas--,this.minasBienMarcadas==this.cantidadMinas&&this.celdasMarcadas==this.cantidadMinas?this.ganar():this.campo[n][f].estaMarcada=!this.campo[n][f].estaMarcada}perder(){this.perdiste=!0,this.coordenadas.forEach(t=>{this.campo[t.x][t.y].estaRevelada=!0})}ganar(){if(!this.perdiste){Ie({particleCount:100,spread:70,origin:{y:.6}});var t=Te(this.afs,"puntajesBuscaminas"),n={nombre:localStorage.getItem("user"),fecha:Date.now(),puntaje:this.puntuacion()};we(t,n)}}puntuacion(){let t=200/Math.sqrt(this.subscribeTimer);switch(this.cantidadMinas){case 10:break;case 40:t=2*t;break;case 99:t=3*t;break}return t.toFixed(2)}nuevoJuego(){this.empezoElJuego=!1,document.querySelectorAll(".celda").forEach(n=>{this.renderer.removeChild(n.parentNode,n)}),this.campo=[],this.perdiste=!1}static \u0275fac=function(n){return new(n||h)(ue(me))};static \u0275cmp=le({type:h,selectors:[["app-buscaminas"]],viewQuery:function(n,f){if(n&1&&fe(aa,5),n&2){let u;pe(u=ve())&&(f.container=u.first)}},standalone:!0,features:[be],decls:4,vars:2,consts:[["href",de`https://fonts.googleapis.com/css?family=Bungee Hairline`,"rel","stylesheet"],["id","setup",4,"ngIf"],["id","juego",4,"ngIf"],["id","setup"],[3,"click"],["id","juego"],["id","info",4,"ngIf"],["id","campo",1,"campo"],[1,"fila"],["id","info"],[1,"celda",3,"ngClass","disabled"],[1,"celda",3,"click","contextmenu","ngClass","disabled"]],template:function(n,f){n&1&&(w(0,"body"),he(1,"link",0),L(2,ta,9,0,"div",1)(3,ua,7,1,"div",2),I()),n&2&&(V(2),U("ngIf",!f.empezoElJuego),V(),U("ngIf",f.empezoElJuego))},dependencies:[xe,Me,Ce],styles:['body[_ngcontent-%COMP%]{background-image:url("./media/bombs-publicdomainvectors-GUW575N7.png");background-size:cover}.fila[_ngcontent-%COMP%]{display:flex}.celda[_ngcontent-%COMP%]{width:30px;height:30px}#juego[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:center;top:15%;position:relative;flex-direction:column;z-index:2}#setup[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:center;flex-direction:column;top:20%;position:relative;font-family:Bungee Hairline}#setup[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#fff}#setup[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:20px;height:50px;width:110px;font-family:monospace}#info[_ngcontent-%COMP%]{background-color:#d3d3d3;padding-left:15px;padding-right:15px;z-index:0;border-style:ridge;border-width:2px;border-color:#000}']})};export{Ee as BuscaminasComponent};
